# 양자화 추론 모델 종합 분석 리포트
## Comprehensive Analysis of Quantized Reasoning Models

**모델**: DeepSeek-R1-Distill-Qwen-1.5B
**양자화 방법**: AWQ (3/4-bit), GPTQ (3/4-bit), KV-Quant* (4-bit)
**데이터셋**: MATH-500, AIME-90
**분석 날짜**: 2026-01-05
**Random Seed**: 42

---

## Executive Summary

### 핵심 발견

| 양자화 방법 | MATH-500 정확도 | AIME-90 정확도 | 종합 평가 |
|------------|----------------|---------------|----------|
| **Baseline (FP16)** | **85.00%** | **25.56%** | 기준선 |
| **KV-Quant* KV4** | **84.20%** (-0.8pp) | **20.00%** (-5.56pp) | 🏆 **최고 추천** |
| **AWQ 4-bit** | 83.40% (-1.6pp) | 20.00% (-5.56pp) | ✅ 우수 |
| **GPTQ 4-bit** | 83.00% (-2.0pp) | 18.89% (-6.67pp) | ✅ 우수 |
| **GPTQ 3-bit** | 71.40% (-13.6pp) | 10.00% (-15.56pp) | ⚠️ 주의 |
| **AWQ 3-bit** | 52.60% (-32.4pp) | 6.67% (-18.89pp) | ❌ **비권장** |

### 주요 결론

1. **KV-cache 양자화가 가장 효과적**: 0.8pp 손실로 최소 성능 저하
2. **4-bit 양자화는 실용적**: AWQ/GPTQ 모두 1-2pp 손실로 사용 가능
3. **3-bit 양자화는 위험**: 특히 AWQ 3-bit는 repetition degeneration으로 32.4pp 손실
4. **AIME-90에서 더 큰 성능 저하**: 복잡한 수학 문제에서 양자화 영향 증폭
5. **8가지 무한 루프 패턴 발견**: Wait (39.7%), Perhaps (18.6%), Mixed (14.8%), Number Loop (5.5%) 등

---

## 목차

1. [전체 성능 비교](#1-전체-성능-비교)
2. [MATH-500 상세 분석](#2-math-500-상세-분석)
3. [AIME-90 상세 분석](#3-aime-90-상세-분석)
4. [양자화 방법별 비교](#4-양자화-방법별-비교)
5. [에러 패턴 분석](#5-에러-패턴-분석)
6. [AWQ 3-bit Repetition Degeneration 심층 분석](#6-awq-3-bit-repetition-degeneration-심층-분석)
   - 6.6 [다양한 무한 루프 패턴](#66-다양한-무한-루프-패턴-분석)
7. [결론 및 권장사항](#7-결론-및-권장사항)

---

## 1. 전체 성능 비교

### 1.1 정확도 종합 비교

| 모델 | MATH-500 | AIME-90 | 평균 | Baseline 대비 평균 |
|------|----------|---------|------|-------------------|
| Baseline (FP16) | 85.00% | 25.56% | 55.28% | - |
| KV-Quant* KV4 | 84.20% | 20.00% | 52.10% | **-3.18pp** |
| AWQ 4-bit | 83.40% | 20.00% | 51.70% | -3.58pp |
| GPTQ 4-bit | 83.00% | 18.89% | 50.95% | -4.33pp |
| GPTQ 3-bit | 71.40% | 10.00% | 40.70% | -14.58pp |
| AWQ 3-bit | 52.60% | 6.67% | 29.64% | **-25.64pp** |

### 1.2 응답 품질 지표

| 모델 | 평균 응답 길이 (단어) | 평균 Wait 횟수 | 토큰 다양성 | Answer 생성률 |
|------|---------------------|--------------|------------|--------------|
| Baseline | 5,847 | 70.5 | 0.2027 | 91.7% |
| KV-Quant* KV4 | 6,331 | 81.4 | 0.2000 | 89.6% |
| GPTQ 4-bit | 5,643 | 73.9 | 0.1976 | 91.0% |
| GPTQ 3-bit | 6,059 | 69.2 | 0.1773 | 84.0% |
| AWQ 4-bit | 6,436 | 108.0 | 0.1858 | 90.4% |
| **AWQ 3-bit** | **14,320** | **1,250.0** | **0.0869** | **28.7%** |

**주목**: AWQ 3-bit는 응답 길이 2.4배, Wait 횟수 17.7배, 토큰 다양성 57% 감소

---

## 2. MATH-500 상세 분석

### 2.1 정확도 및 성능 메트릭

| 모델 | 정확도 | 정답/전체 | 평균 단어 (정답) | 평균 단어 (오답) | Wait (오답) |
|------|-------|----------|-----------------|----------------|-------------|
| Baseline | 85.00% | 425/500 | 2,017 | 8,461 | 119.3 |
| KV-Quant* KV4 | **84.20%** | 421/500 | 1,988 | 8,553 | 145.1 |
| AWQ 4-bit | 83.40% | 417/500 | 1,910 | 8,225 | 184.0 |
| GPTQ 4-bit | 83.00% | 415/500 | 1,728 | 9,068 | 137.4 |
| GPTQ 3-bit | 71.40% | 357/500 | 1,607 | 6,248 | 94.9 |
| AWQ 3-bit | 52.60% | 263/500 | 6,714 | **16,446** | **1,318.1** |

### 2.2 문제 유형별 성능 (MATH-500)

기존 분석 결과에서 확인된 문제 유형별 성능:

| 문제 유형 | Baseline | AWQ 4-bit | AWQ 3-bit | 3-bit 하락 |
|---------|----------|-----------|-----------|-----------|
| Functions | 100.0% | 95.7% | 56.5% | **-43.5pp** |
| Geometry | 75.3% | 66.2% | 36.4% | **-39.0pp** |
| Combinatorics | 87.1% | 77.4% | 48.4% | **-38.7pp** |
| Probability | 68.8% | 87.5% | 31.2% | **-37.5pp** |
| Number Theory | 87.4% | 84.5% | 54.4% | -33.0pp |
| **Trigonometry** | 81.8% | 90.9% | 18.2% | **-63.6pp** |
| Algebra | 77.3% | 84.1% | 54.5% | -22.7pp |

**핵심 발견**:
- 삼각함수(Trigonometry) 문제가 AWQ 3-bit에서 가장 취약 (63.6pp 하락)
- 기하학(Geometry), 조합론(Combinatorics)도 38-39pp 하락
- 대수학(Algebra)은 상대적으로 견고 (22.7pp 하락)

### 2.3 교차 정확도 분석 (Baseline vs AWQ 4-bit vs AWQ 3-bit)

| 카테고리 | 개수 | 비율 | 의미 |
|---------|------|------|------|
| 3개 모델 모두 정답 | 247 | 49.4% | 안정적인 문제 |
| Baseline + AWQ4 정답, AWQ3 오답 | 147 | 29.4% | **3-bit 양자화 손실** |
| Baseline만 정답 | 24 | 4.8% | 양자화 민감 문제 |
| AWQ4만 정답 | 17 | 3.4% | AWQ4가 도움 |
| AWQ4 + AWQ3 정답, Baseline 오답 | 6 | 1.2% | 양자화가 오히려 도움 |
| 3개 모델 모두 오답 | 49 | 9.8% | 본질적으로 어려운 문제 |

---

## 3. AIME-90 상세 분석

### 3.1 정확도 비교

AIME-90은 MATH-500보다 훨씬 어려운 데이터셋으로, 모든 모델에서 낮은 정확도를 보입니다.

| 모델 | 정확도 | 정답/전체 | Baseline 대비 | 평균 응답 길이 | 평균 Wait 횟수 |
|------|-------|----------|--------------|---------------|--------------|
| Baseline | **25.56%** | 23/90 | - | 8,711 | 107.8 |
| KV-Quant* KV4 | 20.00% | 18/90 | -5.56pp | 9,637 | 123.3 |
| AWQ 4-bit | 20.00% | 18/90 | -5.56pp | 9,913 | 169.3 |
| GPTQ 4-bit | 18.89% | 17/90 | -6.67pp | 8,309 | 111.4 |
| GPTQ 3-bit | 10.00% | 9/90 | -15.56pp | 9,183 | 97.0 |
| **AWQ 3-bit** | **6.67%** | 6/90 | **-18.89pp** | **17,312** | **1,531.4** |

### 3.2 AIME-90 vs MATH-500 성능 저하 비교

| 모델 | MATH-500 저하 | AIME-90 저하 | AIME-90 추가 영향 |
|------|--------------|-------------|------------------|
| KV-Quant* KV4 | -0.8pp | -5.56pp | **-4.76pp** |
| AWQ 4-bit | -1.6pp | -5.56pp | **-3.96pp** |
| GPTQ 4-bit | -2.0pp | -6.67pp | **-4.67pp** |
| GPTQ 3-bit | -13.6pp | -15.56pp | **-1.96pp** |
| AWQ 3-bit | -32.4pp | -18.89pp | **+13.51pp** |

**해석**:
- AIME-90의 높은 난이도로 인해 양자화 영향이 더 크게 나타남
- 단, AWQ 3-bit는 MATH-500에서 이미 너무 심각하게 손상되어 AIME-90에서 추가 저하가 상대적으로 작음
- 4-bit 양자화는 AIME-90에서 추가로 4-5pp 손실

### 3.3 응답 품질 분석 (AIME-90)

| 모델 | 토큰 다양성 | Answer 생성률 | 평균 Wait (오답) |
|------|-----------|--------------|----------------|
| Baseline | 0.1548 | 85.6% | 132.5 |
| KV-Quant* KV4 | 0.1470 | 81.1% | 139.3 |
| GPTQ 4-bit | 0.1459 | 85.6% | 128.5 |
| AWQ 4-bit | 0.1288 | 83.3% | 200.6 |
| GPTQ 3-bit | 0.1180 | 73.3% | 112.6 |
| **AWQ 3-bit** | **0.0552** | **14.4%** | **1,692.5** |

**핵심 발견**:
- AWQ 3-bit는 AIME-90에서 Answer 생성률이 14.4%로 폭락 (MATH-500: 43.0%)
- 토큰 다양성 0.055는 "20개 토큰 중 1개만 고유"를 의미
- 평균 Wait 횟수 1,531회는 심각한 repetition degeneration

---

## 4. 양자화 방법별 비교

### 4.1 AWQ vs GPTQ (4-bit)

| 지표 | AWQ 4-bit | GPTQ 4-bit | 우위 |
|------|-----------|-----------|------|
| MATH-500 정확도 | 83.40% | 83.00% | AWQ +0.4pp |
| AIME-90 정확도 | 20.00% | 18.89% | AWQ +1.11pp |
| 평균 응답 길이 | 6,436 | 5,643 | GPTQ (더 간결) |
| 평균 Wait 횟수 | 108.0 | 73.9 | GPTQ (더 안정) |
| 토큰 다양성 | 0.1858 | 0.1976 | GPTQ (더 다양) |
| Answer 생성률 | 90.4% | 91.0% | GPTQ +0.6pp |

**결론**: GPTQ 4-bit가 AWQ 4-bit보다 약간 낮은 정확도지만, 더 안정적인 응답 생성

### 4.2 AWQ vs GPTQ (3-bit)

| 지표 | AWQ 3-bit | GPTQ 3-bit | 차이 |
|------|-----------|-----------|------|
| MATH-500 정확도 | 52.60% | 71.40% | GPTQ **+18.8pp** |
| AIME-90 정확도 | 6.67% | 10.00% | GPTQ +3.33pp |
| 평균 응답 길이 | 14,320 | 6,059 | GPTQ **57.7% 짧음** |
| 평균 Wait 횟수 | 1,250.0 | 69.2 | GPTQ **94.5% 감소** |
| 토큰 다양성 | 0.0869 | 0.1773 | GPTQ **2.0배** |
| Severe Repetition (Wait > 1000) | 130개 (22.0%) | 1개 (0.6%) | GPTQ 훨씬 안정 |

**결론**: GPTQ 3-bit가 AWQ 3-bit보다 압도적으로 우수. AWQ는 3-bit에서 심각한 repetition degeneration.

### 4.3 KV-Cache 양자화의 효과

KV-Quant* KV4는 weight가 아닌 KV-cache를 양자화하는 방법입니다.

**장점**:
- MATH-500: 0.8pp 손실로 최소 성능 저하
- 높은 토큰 다양성 유지 (0.2000)
- 안정적인 Answer 생성률 (89.6%)

**단점**:
- AIME-90에서는 5.56pp 손실 (4-bit weight 양자화와 동일)
- 복잡한 추론에서는 KV-cache도 중요함을 시사

### 4.4 양자화 방법 종합 평가

| 양자화 방법 | 정확도 | 안정성 | 메모리 절감 | 추천도 |
|------------|-------|-------|-----------|-------|
| **KV-Quant* KV4** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 🏆 **최고** |
| **GPTQ 4-bit** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ✅ 우수 |
| **AWQ 4-bit** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ✅ 우수 |
| **GPTQ 3-bit** | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⚠️ 제한적 |
| **AWQ 3-bit** | ⭐ | ⭐ | ⭐⭐⭐⭐⭐ | ❌ 비권장 |

---

## 5. 에러 패턴 분석

### 5.1 에러 유형 통계

전체 1,151개 오답 케이스 분석:

| 에러 유형 | 개수 | 비율 | 주요 원인 |
|---------|------|------|----------|
| **Severe Repetition (Wait > 1000)** | 141 | 12.3% | Attention 메커니즘 손상 |
| **Moderate Repetition (100 < Wait ≤ 1000)** | 579 | 50.3% | 부분적 attention 실패 |
| **Garbled Text** | 160 | 13.9% | LM Head 확률 분포 왜곡 |
| **Missing Answer** | 438 | 38.1% | 추론 중단, 결론 미도달 |
| **Low Token Diversity (< 0.1)** | 588 | 51.1% | Mode collapse |

**주목**: "Wait," 외에도 "Perhaps", "Let me" 등 **8가지 무한 루프 패턴** 발견 (상세 내용은 Section 6.6 참조):
- Wait Loop (39.7%), Perhaps Loop (18.6%), Mixed Loop (14.8%)
- Number Loop (5.5%), Phrase Repeat (11.4%) 등

### 5.2 모델별 에러 패턴

| 모델 | Total Errors | Severe Rep | Garbled | Missing Answer | Missing Answer (%) |
|------|-------------|-----------|---------|----------------|-------------------|
| AWQ 3-bit (MATH-500) | 237 | 94 (39.7%) | 107 | 210 | **88.6%** |
| AWQ 3-bit (AIME-90) | 84 | 36 (42.9%) | 27 | 75 | **89.3%** |
| AWQ 4-bit (MATH-500) | 83 | 2 (2.4%) | 3 | 13 | 15.7% |
| AWQ 4-bit (AIME-90) | 72 | 3 (4.2%) | 3 | 15 | 20.8% |
| GPTQ 3-bit (MATH-500) | 143 | 1 (0.7%) | 7 | 24 | 16.8% |
| GPTQ 4-bit (MATH-500) | 85 | 2 (2.4%) | 2 | 16 | 18.8% |
| Baseline (MATH-500) | 75 | 0 (0%) | 2 | 9 | 12.0% |

**핵심 발견**:
- AWQ 3-bit만 Severe Repetition 비율이 40% 수준
- GPTQ 3-bit는 0.7%로 매우 낮음 → 양자화 알고리즘의 차이
- Missing Answer는 AWQ 3-bit에서 압도적으로 높음 (88%)

---

## 6. AWQ 3-bit Repetition Degeneration 심층 분석

### 6.1 현상 개요

AWQ 3-bit는 **Repetition Degeneration**이라는 독특한 실패 모드를 보입니다:
- 응답 길이: 정답 6,714 단어 vs 오답 16,446 단어 (2.45배)
- Wait 횟수: 정답 415회 vs 오답 906회 (2.18배)
- 토큰 다양성: 정답 0.175 vs 오답 0.049 (72% 감소)

### 6.2 반복 패턴 유형

#### Type A: Wait Loop (가장 흔함, 40%)
```
Wait, wait, wait, perhaps I can think of tan tan tan tan tan.
Wait, wait, wait, perhaps I can think of tan tan tan tan tan.
Wait, wait, wait, perhaps I can think of tan tan tan tan tan.
```
- 최대 반복: 6,167회 (Problem 211)

#### Type B: Number Loop
```
0.  0.  0.  0.  0.  0,0.  0.  0.  0.  0.  0.  0.  0.  0,0.
```

#### Type C: Gibberish Token
```
Vis, no.  Vis, no.  Vis, no.  Vis, no.  Vis, no.  vis, no.
```
- "Vis", "Vi"는 양자화로 인한 토큰 손상

#### Type D: Single Character
```
V.  V.  V.  V.  V.  V.  V.  V.  V.  V.  V.  V.  V.  V.  V.
```

### 6.3 반복 발생 시점

```
응답 진행률 (%)   발생 빈도
 0-10%:           █ (1)
10-20%:           ████ (8)
20-30%:           ███ (6)
30-40%:           ████ (9)
40-50%:           █████ (11)      ← 대부분 전반부-중반부에서 시작
50-60%:           █ (2)
60-70%:           █ (2)
70-80%:           █ (1)
80-90%:           █ (1)
90-100%:          ██████████████████ (59)  ← 끝까지 정상인 척
```

평균 반복 시작 지점: 응답의 약 **25.8%** 지점

### 6.4 근본 원인 분석

#### 가설 1: Attention 메커니즘 손상

**증거 1-1**: 동일 문장 반복 (84% 발생률)
- 50개 오답 샘플 중 42개(84%)에서 동일 문장 5회 이상 반복
- Problem 0: "Wait, perhaps I can think of tan 100°..." → 176회 반복

**증거 1-2**: 자기 참조 빈도 52% 감소
```
측정 대상: "as I", "from above", "earlier", "we found" 등

자기 참조 빈도 (per 1000 words):
  • 정답 응답: 0.72
  • 오답 응답: 0.34  (52% 감소!)
```

#### 가설 2: LM Head 손상

**증거 2-1**: Gibberish 토큰 출현 (1.85배 증가)
```
"Vi", "Vis" 등 의미 없는 토큰 출현 빈도:
  • 정답 응답: 평균 57.3회
  • 오답 응답: 평균 105.9회 (1.85배)
  • 최대: 4,312회
```

**증거 2-2**: 토큰 다양성 붕괴
```
토큰 다양성 = unique tokens / total tokens

전체 응답:
  • 정답 응답: 0.1751
  • 오답 응답: 0.0492  (72% 감소!)

마지막 2000 토큰:
  • 정답 응답: 0.1768
  • 오답 응답: 0.0377  (79% 감소!)
```

### 6.5 실패 메커니즘 다이어그램

```
┌────────────────────────────────────────────────────────────────────────────┐
│                        AWQ 3-BIT 실패 메커니즘                              │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                   │
│  │  3-bit      │ ──► │  Attention  │ ──► │ 이전 context│                   │
│  │  양자화     │     │  Weight 손상│     │ 참조 실패   │                   │
│  └─────────────┘     └─────────────┘     └──────┬──────┘                   │
│                                                  │                         │
│                                                  ▼                         │
│                              ┌─────────────────────────────────┐           │
│                              │    같은 reasoning 패턴 반복     │           │
│                              │    (평균 906회 "Wait," 반복)    │           │
│                              └────────────────┬────────────────┘           │
│                                               │                            │
│  ┌─────────────┐     ┌─────────────┐         │                            │
│  │  3-bit      │ ──► │  LM Head    │         │                            │
│  │  양자화     │     │  Weight 손상│         │                            │
│  └─────────────┘     └─────────────┘         │                            │
│                              │                │                            │
│                              ▼                │                            │
│                      ┌─────────────┐         │                            │
│                      │ 확률 분포   │         │                            │
│                      │ 왜곡        │         │                            │
│                      └──────┬──────┘         │                            │
│                              │                │                            │
│                              ▼                ▼                            │
│                      ┌─────────────────────────────────────┐               │
│                      │    토큰 다양성 붕괴 (0.17 → 0.04)   │               │
│                      │    Gibberish 토큰 생성 (Vi, Vis)   │               │
│                      └────────────────┬────────────────────┘               │
│                                       │                                    │
│                                       ▼                                    │
│                              ┌─────────────────┐                           │
│                              │  최종 답변 생성  │                           │
│                              │  실패 (88.6%)   │                           │
│                              └─────────────────┘                           │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 6.6 다양한 무한 루프 패턴 분석

AWQ 3-bit는 "Wait," 외에도 **다양한 무한 루프 패턴**을 보입니다. 237개 오답 케이스 분석 결과:

| 패턴 유형 | 개수 | 비율 | 평균 단어수 | 주요 특징 |
|---------|------|------|-----------|----------|
| **Wait Loop** | 94개 | **39.7%** | 17,960 | "Wait," 1000회 이상 반복 |
| **Perhaps Loop** | 44개 | **18.6%** | 18,194 | "Perhaps" 100회 이상 반복 |
| **Mixed Loop** | 35개 | 14.8% | 14,150 | Wait + Perhaps + Let me 혼합 |
| **Phrase Repeat** | 27개 | 11.4% | 16,989 | 전체 구문(20-80자) 반복 |
| **Number Loop** | 13개 | 5.5% | 11,347 | 숫자만 무한 반복 (444444...) |
| **Let me Loop** | 11개 | 4.6% | 14,248 | "Let me" 50회 이상 반복 |
| **Word Repeat** | 2개 | 0.8% | 12,020 | 단일 단어 연속 반복 |
| **No Clear Loop** | 11개 | 4.6% | 11,512 | 명확한 루프 패턴 없음 |

#### 패턴별 상세 예시

**① Wait Loop (39.7%)** - 가장 흔한 패턴
```
Wait, wait, wait, perhaps I can think of tan tan tan tan tan.
Wait, wait, wait, perhaps I can think of tan tan tan tan tan.
Wait, wait, wait, perhaps I can think of tan tan tan tan tan.
```
- 최악 케이스: Problem 47 (Wait 9,075회, 19,758 단어)

**② Perhaps Loop (18.6%)**
```
which is a linear function, which is a linear function, which is a linear function,
which is a linear function, which is a linear function, which is a linear function...
```
- 최악 케이스: Problem 76 (Perhaps 905회 in문맥, 22,567 단어)

**③ Let me Loop (4.6%)**
```
Wait, but let me think of another solution, but f(x) is decreasing...
Wait, but let me think of another solution, but f(x) is decreasing...
Wait, but let me think of another solution, but f(x) is decreasing...
```
- 최악 케이스: Problem 203 (Let me 354회, 23,505 단어)

**④ Number Loop (5.5%)** - 극단적 mode collapse
```
44444444444444444444444444444444444444444444444444444444444444444...
```
- LM Head가 단일 토큰(숫자 4)만 생성

**⑤ Mixed Loop (14.8%)** - 복합 패턴
```
Wait 3,382회 + Perhaps 1,256회 동시 발생
마지막 부분이 완전히 붕괴된 상태
```

**⑥ Phrase Repeat (11.4%)** - 구문 전체 반복
```
[20-80자 길이의 전체 문장]을 그대로 3회 이상 반복
문맥과 무관하게 같은 추론 패턴 계속 반복
```

#### 핵심 발견

1. **"Wait," 만이 아니다**:
   - 특정 마커(Wait, Perhaps, Let me) 반복: **62.9%**
   - 구문/숫자/단어 반복: **17.7%**
   - 명확한 루프 없음: 4.6%

2. **다양한 degeneration 모드**:
   - 사고 과정 마커 반복 (Wait, Perhaps, Let me)
   - 숫자 고착 (Number Loop)
   - 구문 고착 (Phrase Repeat)

3. **평균 응답 길이 차이**:
   - 루프 패턴 있음: 평균 15,000-18,000 단어
   - 루프 없음: 평균 11,500 단어
   - **루프 발생 시 1.5배 이상 길어짐**

4. **복합 패턴의 심각성**:
   - Mixed Loop는 여러 마커가 동시 반복
   - Problem 0: Wait 3,382회 + Perhaps 1,256회 = 총 4,638회 마커
   - 응답의 대부분이 무의미한 반복으로 채워짐

---

### 6.7 AWQ 3-bit 성공/실패 결정 요인

#### 성공 조건 (52.6% 케이스)

| 유형 | 비율 | 특징 | 메커니즘 |
|------|------|------|----------|
| **Short & Clean** | 52.1% | 평균 1,388 단어, 14회 Wait | 반복 루프 진입 전 빠른 정답 도출 |
| **Medium Clean** | 14.4% | 평균 3,390 단어, 81회 Wait | 재검토하면서도 정답 유지 |
| **Long but Survived** | 14.8% | 평균 14,674 단어, 235회 Wait | 긴 응답이지만 정답 포함 |
| **High Wait, Survived** | 18.6% | 평균 17,849 단어, 1,938회 Wait | 루프 전 정답 계산 완료 |

#### 실패 조건 (47.4% 케이스)

| 유형 | 비율 | 특징 | 메커니즘 |
|------|------|------|----------|
| **Early Loop Entry** | 52.3% | 정답 없음 | 초기 추론 단계에서 바로 루프 진입 |
| **Incomplete Calculation** | 31.6% | 정답 있으나 결론 없음 | 중간 계산 후 루프 진입 |
| **False Positive** | 16.1% | 우연히 정답 등장 | 문제문이나 다른 맥락에 정답 포함 |

#### 문제 복잡도별 성공률 (Baseline 응답 길이 기준)

| Baseline 응답 길이 | 성공률 | 실패 예측력 |
|-------------------|--------|------------|
| < 500 단어 | **80.0%** | 낮음 |
| 500-1,500 단어 | **70-73%** | 중간 |
| 1,500-3,000 단어 | **41-57%** | 높음 |
| > 3,000 단어 | **14-19%** | **매우 높음 (81% 실패)** |

---

## 7. 결론 및 권장사항

### 7.1 양자화 방법 선택 가이드

#### 📊 정확도 우선 시나리오
```
FP16 Baseline (85.0%) → 필수
```

#### ⚖️ 정확도-메모리 균형 시나리오
```
KV-Quant* KV4 (84.2%, -0.8pp) → 최고 추천
    ↓ (KV-cache 양자화 불가시)
GPTQ 4-bit (83.0%, -2.0pp) → 안정성 우선
    또는
AWQ 4-bit (83.4%, -1.6pp) → 정확도 우선
```

#### 💾 메모리 극한 최적화 시나리오
```
GPTQ 3-bit (71.4%, -13.6pp) → 제한적 사용
    ⚠️ 조건:
    - 간단한 문제 (< 1,500 단어 추론)
    - 배치 추론으로 일부 실패 허용 가능
```

#### ❌ 사용 비권장
```
AWQ 3-bit (52.6%, -32.4pp)
    - Repetition degeneration 심각
    - 88.6% 케이스에서 답변 생성 실패
    - 추론 모델에는 부적합
```

### 7.2 데이터셋별 권장사항

| 데이터셋 유형 | 추천 양자화 | 이유 |
|-------------|-----------|------|
| **MATH-500 수준 (85% baseline)** | KV-Quant* KV4 또는 4-bit | 0.8-2.0pp 손실로 실용적 |
| **AIME-90 수준 (26% baseline)** | Baseline 또는 KV-Quant* KV4 | 어려운 문제는 양자화 영향 큼 |
| **단순 수학 (< 1,500 단어)** | GPTQ 3-bit 가능 | 70% 수준 성능 유지 |
| **복잡한 다단계 추론** | Baseline 권장 | 양자화 시 심각한 성능 저하 |

### 7.3 핵심 연구 발견

1. **양자화 임계점 존재**
   - 4-bit → 3-bit 전환 시 급격한 성능 저하
   - AWQ: 83.4% → 52.6% (30.8pp 하락)
   - GPTQ: 83.0% → 71.4% (11.6pp 하락)

2. **양자화 알고리즘의 중요성**
   - 같은 3-bit여도 AWQ와 GPTQ는 18.8pp 차이
   - GPTQ가 repetition degeneration에 더 견고

3. **KV-cache 양자화의 우수성**
   - Weight 양자화보다 안정적
   - MATH-500에서 0.8pp 손실로 최소 영향

4. **Repetition Degeneration 메커니즘 규명**
   - Attention 메커니즘 손상 → 자기 참조 52% 감소
   - LM Head 손상 → 토큰 다양성 72% 감소
   - 두 요인의 악순환 루프

5. **문제 복잡도와 양자화 손실의 상관관계**
   - Baseline 응답 3,000 단어 초과 → 81% 실패 (AWQ 3-bit)
   - 간단한 문제는 양자화에 견고

### 7.4 향후 연구 방향

1. **양자화 알고리즘 개선**
   - AWQ 3-bit의 repetition 문제 해결
   - GPTQ의 안정성을 AWQ에 적용

2. **적응적 양자화**
   - 문제 복잡도에 따라 동적으로 양자화 비트 조정
   - 중요 레이어는 4-bit, 덜 중요한 레이어는 3-bit

3. **KV-cache 양자화 최적화**
   - Weight + KV-cache 동시 양자화
   - AIME-90에서의 성능 저하 개선

4. **특정 도메인 최적화**
   - 삼각함수, 기하학 등 취약 영역 특화 양자화

---

## 부록: 데이터 및 재현성

### A.1 분석 데이터

- **총 분석 샘플**: 3,540개 (6 모델 × 2 데이터셋 × ~300-500 문제)
- **데이터 위치**:
  - 원본 데이터: `outputs/inference/`
  - 분석 결과: `analysis_results/`
  - 중간 데이터: `analysis_results/intermediate_data/`
  - 테이블: `analysis_results/tables/`
  - 통계: `analysis_results/statistics/`

### A.2 재현 방법

```bash
# 종합 분석 실행
python scripts/analysis/comprehensive_analysis.py \
    --seed 42 \
    --inference_dir ./outputs/inference \
    --output_dir ./analysis_results

# 개별 모델 분석
python scripts/analysis/analyze_responses.py \
    --seed 42 \
    --datasets MATH-500 AIME-90 \
    --models [모델명]
```

### A.3 논문용 테이블 형식

모든 표는 다음 형식으로 제공:
- CSV: 데이터 처리용
- LaTeX: 논문 작성용
- Markdown: 문서화용

위치: `analysis_results/tables/`

### A.4 통계적 유의성

- 각 모델당 90-500개 샘플로 통계적으로 유의미
- Random seed 42로 재현 가능
- Extractive match 메트릭 사용 (정답 추출 기반)

---

**보고서 작성**: 2026-01-05
**분석 도구**: Python, pandas, numpy
**모델 버전**: DeepSeek-R1-Distill-Qwen-1.5B
**양자화 라이브러리**: AutoAWQ, AutoGPTQ, QuaRot (KV-Quant*)
